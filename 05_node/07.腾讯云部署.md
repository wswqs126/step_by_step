# 腾讯云部署 Node + MongoDB

选腾讯[云服务器 CVM](https://cloud.tencent.com/product/cvm) 是因为有 7 天免费使用，google 什么的还要绑定信用卡太麻烦。

免费试用配置选择默认，系统为 CentOS 7.4 。

## 使用

### 拿到公网 ip 和登录密码

云主机建立以后会发送公网 ip 和登录密码到注册邮箱，后面远程登录会用到。

### 远程登录

在命令行输入下面命令登录远程主机

```bash
# 登录远程主机
ssh root@< 主机公网 ip >
```

然后会提示输入密码。

> centOS 默认 `～/` 为 `root` 目录

### 登录后安装 node，mongodb，git

1.  安装 node

这里安装 8.x 版本的 node：

```bash
# 配置 rpm 仓库
curl --silent --location https://rpm.nodesource.com/setup_8.x | sudo bash -

# 安装 Node.js
sudo yum -y install nodejs

# 查看 Node 版本
node -v
```

> centOS 使用 yum 进行包管理

2.  安装 mongodb

1）Configure the package management system (yum).

Configure the package management system (yum).
Create a `/etc/yum.repos.d/mongodb-org-3.6.repo` file so that you can install MongoDB directly, using yum.

```bash
# 创建 mongodb 仓库信息
vi /etc/yum.repos.d/mongodb-org-3.6.repo
```

mongodb-org-3.6.repo 内容如下：

```bash
[mongodb-org-3.6]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.6/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-3.6.asc
```

> 根据需要更改安装版本

2）Install the MongoDB packages

```bash
# 安装 mogodb
sudo yum install -y mongodb-org
```

3）安装 git

```bash
sudo yum install git-all
```

4）安装 yarn

```bash
# 添加 RPM 包仓库
sudo wget https://dl.yarnpkg.com/rpm/yarn.repo -O /etc/yum.repos.d/yarn.repo
```

如果没有安装 nodejs，也应该配置 the NodeSource repository

```bash
# 配置 the NodeSource repository
curl --silent --location https://rpm.nodesource.com/setup_6.x | sudo bash -
```

安装

```bash
sudo yum install yarn

## OR ##
sudo dnf install yarn
```

> 如果安装完 git clone 的时候出现错误，配置自己的 public/private key pair [Git - Permission denied (publickey)](https://stackoverflow.com/questions/2643502/git-permission-denied-publickey)

## 参考资料

【1】[腾讯云服务器部署 Node.js 应用](http://yedanbo.com/post/2017/qcloud-deploy-nodejs-application/)  
【2】[Install MongoDB Community Edition on Red Hat Enterprise or CentOS Linux](https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/)
